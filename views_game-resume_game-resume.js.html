<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: views/game-resume/game-resume.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: views/game-resume/game-resume.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Game, Backlog, User } from "../../data/game_class.js"

const gameId = new URLSearchParams(window.location.search).get('id');
const game = Game.initFromId(gameId)
displayData()

function displayData() {
    document.getElementById("resume-title").textContent += game.name
    const backlogsContainer = document.getElementById("backlogs-container")

    // Display backlogs data*
    game.backlogs.forEach((backlog, i) => {
        const newBacklogElement = document.createElement("div");
        const newContent = document.createTextNode(backlog.title);
        newBacklogElement.classList.add("backlog-resume-list");
        if (i === 0) {
            newBacklogElement.classList.add("backlog-selected");
            backlogSelected(game.backlogs[i])
        }
        newBacklogElement.id = `backlog-${i}`

        newBacklogElement.appendChild(newContent);

        newBacklogElement.addEventListener("click", () => {
            const backlogs = document.getElementsByClassName("backlog-resume-list")
            for (let backlog of backlogs) {
                backlog.classList.remove("backlog-selected")
            }
            newBacklogElement.classList.add("backlog-selected")
            backlogSelected(game.backlogs[i])
        })

        backlogsContainer.insertAdjacentElement("beforeend", newBacklogElement)
    })
}

/**
 * @param {Backlog} backlog
 */
function backlogSelected(backlog) {
    const backlogData = document.getElementById("backlog-data")
    const backlogTitle = backlogData.childNodes[1]
    const backlogDescription = backlogData.childNodes[3]
    const backlogButton = backlogData.childNodes[5]

    backlogTitle.textContent = backlog.title
    if (backlogDescription.childNodes.length >= 2) {
        backlogDescription.removeChild(backlogDescription.lastChild);
    }
    const descriptionText = document.createTextNode(backlog.description != null &amp;&amp; backlog.description !== "" ? backlog.description : "Pas de description")
    backlogDescription.appendChild(descriptionText)
    switch (backlog.finalRate) {
        case -2:
            backlogButton.classList.remove("disabled")
            backlogButton.textContent = "Commencer le vote de la fonctionnalité"
            backlogButton.onclick = () => {
                window.location.href = "../game/game.html?id=" + game.id + "&amp;backlog=" + backlog.id
            }
            break;
        case -1:
            backlogButton.classList.remove("disabled")
            backlogButton.textContent = "Reprendre le vote de la fonctionnalité"
            backlogButton.onclick = () => {
                window.location.href = "../game/game.html?id=" + game.id + "&amp;backlog=" + backlog.id
            }
            break;
        default:
            backlogButton.onclick = (e) => { e.preventDefault() }
            backlogButton.classList.add("disabled")
            backlogButton.textContent = "Le vote de la fonctionnalité a déjà été effectué"
            break;
    }
    displayNotes(backlog)
    displayFinalNote(backlog.finalRate)
}

function displayFinalNote(finalNote) {
    const finalNoteElement = document.getElementById("final-note")
    finalNoteElement.textContent = finalNote &lt; 0 ? "" : "Note finale : " + finalNote
}

function displayNotes(backlog) {
    const notesContainer = document.getElementById("backlog-votes")
    if (backlog.finalRate === -2) {
        notesContainer.style.display = "none"
    } else {
        notesContainer.style.display = "block"
        const cardsContainer = document.querySelector(".cards-container")
        while (cardsContainer.firstChild) {
            cardsContainer.removeChild(cardsContainer.lastChild);
        }
        for (let user of game.users) {
            const value = backlog.valueRateFromUser(user)
            const cardPath = value === -1 ? "../../cartes/cartes_interro.svg" : `../../cartes/cartes_${value}.svg`
            const newCard = document.createElement("div")
            newCard.classList.add("card")
            newCard.dataset.value = value
            const newCardText = document.createElement("p")
            newCardText.textContent = user.name
            const newCardImage = document.createElement("img")
            newCardImage.src = cardPath
            newCardImage.alt = "Carte " + value
            newCard.appendChild(newCardText)
            newCard.appendChild(newCardImage)
            cardsContainer.insertAdjacentElement("beforeend", newCard)
        }
    }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Backlog.html">Backlog</a></li><li><a href="Game.html">Game</a></li><li><a href="User.html">User</a></li></ul><h3>Global</h3><ul><li><a href="global.html#backlogSelected">backlogSelected</a></li><li><a href="global.html#deleteItem">deleteItem</a></li><li><a href="global.html#getItem">getItem</a></li><li><a href="global.html#setItem">setItem</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Fri Dec 20 2024 15:33:57 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
